<!-- Copyright (C) 2016 NooBaa -->

<managed-form class="column greedy" params="
    name: formName,
    fields: fields,
    onValidateSubmit: values => onValidateSubmit(values, existingTriggers),
    onSubmit: onSubmit
">
    <div class="column greedy pad">
        <p>Triggers will automatically invoke the selected function.</p>

        <!-- ko if: funcName -->
        <editor params="label: 'Bucket'">
            <dropdown params="
                    options: bucketOptions,
                    selected: $form.bucket,
                    placeholder: 'Choose Bucket',
                    hasFocus: true
                "
                ko.validationCss="$form.bucket"
            ></dropdown>
            <validation-message params="field: $form.bucket"></validation-message>
        </editor>
        <!-- /ko -->

        <!-- ko ifnot: funcName -->
        <editor params="label: 'Function'">
            <dropdown params="
                    options: funcOptions,
                    actions: funcActions,
                    selected: $form.func,
                    placeholder: 'Choose Function',
                    hasFocus: true
                "
                ko.validationCss="$form.func"
            ></dropdown>
            <validation-message params="field: $form.func"></validation-message>
        </editor>
        <!-- /ko -->

        <editor params="label: 'Event Type'">
            <dropdown params="
                    options: eventOptions,
                    selected: $form.event,
                    placeholder: 'Choose Event'
                "
                ko.validationCss="$form.event"
            ></dropdown>
            <validation-message params="field: $form.event"></validation-message>
        </editor>

        <editor params="label: 'Prefix'">
            <input type="text"
                placeholder="e.g. Images/"
                ko.value="$form.prefix"
                ko.validationCss="$form.prefix"
            />
            <p class="hint">optional</p>
        </editor>

        <editor params="label: 'Suffix'">
            <input type="text"
                placeholder="e.g. .jpg"
                ko.value="$form.suffix"
                ko.validationCss="$form.suffix"
            />
            <p class="hint">optional</p>
        </editor>

        <editor params="label: 'Trigger Active'">
            <toggle-switch params="value: $form.active"></toggle-switch>
        </editor>
    </div>
    <div class="row content-middle pad content-box">
        <div class="row content-middle greedy push-next remark">
            <!-- ko if: $form.errors().global -->
            <svg-icon class="error icon-small push-next-half" params="name: 'problem'"></svg-icon>
            <p class="error">{{$form.errors().global}}</p>
            <!-- /ko -->

            <!-- ko ifnot: $form.errors().global -->
            <svg-icon class="icon-small push-next-half" params="name: 'notif-info'"></svg-icon>
            <p>
               To create a new function go to
               <a class="link" ko.attr.href="funcsUrl">Functions </a>
               &gt; Create Function
            </p>
            <!-- /ko -->
       </div>
        <button type="button"
            class="link alt-colors push-next"
            ko.click="onCancel"
        >
            Cancel
        </button>
        <button class="btn" ko.shakeOnClick="!$form.isValid()">
            Save
        </button>
    </div>
</managed-form>

