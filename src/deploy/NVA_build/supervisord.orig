#!/bin/sh

# chkconfig: - 15 15

. /etc/rc.d/init.d/functions

SUPERVISORD="/usr/bin/supervisord"
PIDFILE="/tmp/supervisord.pid"

start() {
    if [ ! -x "$SUPERVISORD" ]; then
        echo "$SUPERVISORD is not executable."
        exit 1
    fi

    echo "Starting ..."
    ulimit -n 102400; $SUPERVISORD --pidfile $PIDFILE

    return $?
}

stop() {
    echo "Stopping ..."
    kill -9 `cat $PIDFILE`
    [ $? -eq 0 ] && rm -f $PIDFILE
    return $retval
}

case $1 in
    start)
        start
    ;;
    stop)
        stop
    ;;
    restart)
        stop
        start
    ;;
    *)
        echo "$0 start|stop|restart"
        exit 2
    ;;
esac
